<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="StudentMapper">

	<resultMap id="studentSelectMap" type="student">
		<result property="userId" column="id" jdbcType="VARCHAR"/>
		<result property="password" column="password" jdbcType="VARCHAR"/>
		<result property="email" column="email" jdbcType="VARCHAR"/>
		<result property="userName" column="name" jdbcType="VARCHAR"/>
		<result property="phone" column="phone" jdbcType="VARCHAR"/>
		<result property="addr" column="addr" jdbcType="VARCHAR"/>
		<result property="targetLang" column="stulang" jdbcType="VARCHAR"/>
		<result property="nativeLang" column="mlang" jdbcType="VARCHAR"/>
		<result property="stuLevel" column="stu_level" jdbcType="VARCHAR"/>
		<result property="role" column="role" jdbcType="VARCHAR"/>	
		<result property="joindate" column="join_date" jdbcType="DATE"/>
		<result property="flag" column="flag" jdbcType="BOOLEAN"/>
		
	</resultMap>

	<insert id="addStudent" parameterType="student">
		INSERT
		INTO student (id, password, email, name, phone, addr, stulang, mlang, stu_level, role, join_date, flag)
		VALUES (#{userId}, #{password}, #{email}, #{userName}, #{phone}, #{addr}, #{targetLang},			
			<if test="nativeLang == null">null</if>
			<if test="nativeLang != null">#{nativeLang}</if>,
		 	
		 	<if test="stuLevel == null">null</if>
		 	<if test="stuLevel != null">#{stuLevel}</if>,
		  	'학생', SYSDATE(), true)	
	</insert>

	<select id="getStudent" parameterType="string" resultMap="studentSelectMap">
		SELECT
		id, password, email, name, phone, addr, stulang, mlang, stu_level, role, join_date 
		FROM student
		where id=#{value}	
	</select>

	<update id="updateStudent">
		UPDATE student
		<set>
			password = #{password},
			email = #{email}, 
			name = #{userName}, 
			phone = #{phone}, 
			addr = #{addr},  
			stulang = #{targetLang}, 
			mlang = #{nativeLang}, 
			stu_level = #{stuLevel}		
		</set>
		WHERE id=#{userId}
	</update>
	
	<update id="updateLeaveStudent">
		UPDATE student
		<set>			
			flag = false		
		</set>
		WHERE id=#{userId}	
	</update>
	
	
	 <!-- SQL : SELECT ROW Count -->	
	<!--SELECT COUNT(*)
	FROM
	(
	SELECT 
	) -->
	
	
</mapper>		
		 